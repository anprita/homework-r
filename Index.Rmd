---
title: "R Homework"
author: "prita, heva, supria"
date: "March 29, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data Visualization in R : Long-term monitoring of a rodent community

Our homework is analyzing database of a long term monitoring for rodent community in Chihuahuan Desert ecosystem near Portal, Arizona, from 1977 to 2000. At this site, 24 experimental plots were established in 1977 and divided among controls and experimental manipulations. The long-term data for the rodent community at the Portal Project has been used to address a variety of questions including
<ul>
  <li>Monitoring the population-level dynamics of desert rodents & competitive interactions among rodent species.</li>
  <li>Responses of rodents to climatic variability.</li>
  <li>The long-term stability and dynamics of a desert rodent community.</li>
</ul>  

This is our R-homework documentation. The process of data visualisation using R can be 
divided into four steps : 

<ul>
  <li>Load the library</li>
  <li>Read the data file</li>
  <li>Clean the data</li>
  <li>Prita : Time series of plot type per year</li>
  <li>Prita : Time series of plot type per sex</li>
  <li>Supria : Correlation between hindfoot length and weight</li>
  <li>Supria : Correlation between hindfoot length and weight</li>
  <li>Heva : Correlation between hindfoot length and genus</li>
  <li>Heva : Correlation between hindfoot length and genus</li>
</ul>

<strong>Load the library</strong>

```{r load, warning=FALSE, message=FALSE}
library(tidyverse)
library(lubridate)
library(gridExtra)
library(ggplot2)
library(dbplyr)
```

<strong>Read the data file</strong>

```{r read}
surveys_combined <- read.csv("data/combined.csv")
```

Our team decide to read the combined.csv file because it has the most comprehensive, consise, and compact data. Below is the information about the data structure:
<div id="str">
  <img src="image/str.png" alt="">
</div> 

<strong>Clean the data</strong>

```{r clear1}
surveys_combined_clear<- surveys_combined %>% filter(!is.na(sex), 
                                                         sex != "",
                                                         !is.na(hindfoot_length), 
                                                         hindfoot_length != "",
                                                         !is.na(weight), 
                                                         weight != "") 
```
Our team read the raw data and transform it into consistent data that can be analyzed. It is aimed at improving the content of statistical statements based on the data as well as their reliability. This proces is Data Cleaning. In this homework, we ignore the missing data ('', NULL, is.Na). The result is : 

<table border="1">
<tr><th colspan="2">&nbsp; Data Cleaning &nbsp;</th></tr>
<tr><th>&nbsp; Before &nbsp;</th><th>&nbsp; After &nbsp;</th></tr>
<tr><td>&nbsp; 34,786 &nbsp;</td><td>&nbsp; 30,676 &nbsp;</td></tr>
</table>
<br/>
<strong>Data Plotting</strong>

```{r plot1}
#create line chart plot type per year
year_plot_type <- surveys_combined_clear %>% group_by(year, plot_type) %>% tally()
line_chart <- ggplot(year_plot_type, aes(x=year, y=n, color=plot_type)) + 
  geom_line() + xlab("Year") + ylab("Plot Type")

#create bar chart sex per year
year_sex <- surveys_combined_clear %>% group_by(year, sex) %>% tally()
bar_chart <- ggplot(year_sex, aes(x=year, y=n, color=sex)) + 
  geom_bar(stat="identity") + xlab("Year") + ylab("Sex")

#put chart to grid
timeseries_plot <- grid.arrange(bar_chart, line_chart, ncol=2, widths=c(4,6))

#save plot into image
ggsave("image/plot1.jpg", timeseries_plot, width=10, dpi=300)
```


```{r plot2}
#create boxplot chart weight per plot_type
boxplot_chart_weight <- ggplot(surveys_combined_clear, aes(x=plot_type, y=weight))+
  geom_boxplot()+xlab("plot type")+ylab("Weight (g)") +  geom_jitter() +
  scale_y_log10()

#create boxplot chart hindfoot length per plot_type
boxplot_chart_length <- ggplot(surveys_combined_clear, aes(x=plot_type, y=hindfoot_length))+
  geom_boxplot()+xlab("plot type")+ylab("Length") + geom_jitter()
  scale_y_log10()

#put chart to grid
frequency_plot <- grid.arrange(boxplot_chart_weight, boxplot_chart_length, ncol=2, widths=c(5,5))

#save plot into image
ggsave("image/plot2.jpg", frequency_plot, width=10, dpi=300)
```

```{r plot3}
#supria

```

```{r plot4}
#supria

```

```{r plot5}
#supria

```

```{r plot6}
#heva

```

```{r plot7}
#heva

```

